define(["app"],function(t){function a(a){var i=function(t){return t.substr(5).substr(0,11)+" 完成"},e=[];for(var r in a.workers){var s=a.workers[r];e.push('<img class="pull-right avatar" src="'+s.avatar+'" title="'+s.name+'"/>')}var n='<div class="item J-item" draggable="true" data-id="'+a.id+'">			<p class="taskTitle"><input type="checkbox" class="J-chkFinish" />'+a.title+'</p>			<p>				<span class="pull-left">'+i(a.limit_time)+"</span>				"+e.join("")+"			</p>		</div>",d=$(n);return require(["task-category"],function(t){d.on("dragstart",function(a){t.$dragingTask=$(this)}),d.on("dragover",function(t){t.preventDefault()}),d.on("drop",function(){t.moveTask(t.$dragingTask,$(this))})}),d.showDetail=function(){var a=this;require(["task-detail","dashboard"],function(i,e){var r=a.data("detail");if(r){var s=i.build(r);return void s.show()}t.ajax({url:"/task/"+a.data("id")+".json",success:function(r){if(r.code)return void t.alert(r.message);a.data("detail",r.data),t.util.isEmptyObject(i.dict.levels)&&(i.dict.levels=e.dict.levels,i.dict.repeats=e.dict.repeats);var s=i.build(r.data);s.show()}})})},d}return{build:a}});