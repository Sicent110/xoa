function TaskCategory(t){var a=this;a.id=t.id,a.name=t.name;var o=$('<div class="col-md-4 taskList J-taskList" data-id="'+a.id+'">\n		<h4 class="J-taskCategoryName">\n			'+a.name+'			<button type="button" class="btn btn-primary J-btnAddTask">+任务</button>		</h4>	</div>');return o.find(".J-taskCategoryName").hover(function(){$(this).find(".J-btnAddTask").show()},function(){$(this).find(".J-btnAddTask").hide()}),o.on("click",".J-btnAddTask",function(){var t=new ModalDialog({title:"新任务",content:'<form role="form" style="padding:10px;">				<div class="form-group">					<input type="email" class="form-control" placeholder="任务标题">				</div>				<div class="form-group">					<label>详情</label>					<textarea class="form-control" rows="5"></textarea>				</div>				<div class="form-group">					<button type="button" class="btn btn-success">+负责人</button>					<p class="help-block"></p>				</div>				<div class="checkbox">					<label>						<input type="checkbox">					</label>				</div>							</form>',width:"500px",height:"400px",footer:'<button type="button" class="btn btn-primary">确定</button>'});t.on("click","J-btnAddWorker",function(){var t=$(this),a=t.data("members");a||App.ajax({url:"/project/"+App.aParams.projectId+"/workers.json"})}),t.show()}),$.extend(a,o)}function Task(){}function listenPage(){var t=$("#wrapProjectHead"),a=t.find(".J-btnAddMember");t.hover(function(){a.show()},function(){a.hide()}),a.click(function(){var t=prompt("请输入他的UID，小x会发个加入邀请给他");if(t)return FormatValidator.isInteger(t)?void App.ajax({url:"/project/invite-member.do",data:{projectId:App.aParams.projectId,inviteWorkerId:t.trim()},success:function(t){App.alert(t.message)}}):void App.alert("UID是一个数字 (⊙ｏ⊙) 麻烦叫他进个人信息里看看")})}function showTasks(){App.ajax({url:"/project/"+App.aParams.projectId+"/task-categorys.json",success:function(t){var a=$("#taskCategorys");for(var o in t.data){var s=new TaskCategory(t.data[o]);a.append(s),aCategoryList[s.id]=s}}})}function showProjectInfo(){App.ajax({url:"/project/"+App.aParams.projectId+".json",success:function(t){$("#projectName").text(t.data.name)}})}TaskCategory.prototype.taskList=function(){var t=this;return{addTask:function(a){t.append(a)}}},TaskCategory.prototype.showTasks=function(){var t=this;App.ajax({url:"/project/"+App.aParams.projectId+"/tasks.json",success:function(a){for(var o in a.data){var s=new Task(a.data[o]);console.log(t.taskList),t.taskList.addTask(s)}}})};var aCategoryList={};$(function(){App.loadParam("project/<projectId:\\d+>.htm"),listenPage(),showProjectInfo(),showTasks()});