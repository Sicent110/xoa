基础 - 响应数据
===

- 文档编写：KK

- 2016.11.09

---

服务端响应给前端的数据都用JSON格式

这个JSON格式默认都使用以下结构：

```js
{
	message : '', //响应消息
	code : 0, //返回码，0为正常，非0表示各种不同的失败，自定义，一般从1开始用
	data : null //相关的接口数据，值的类型不限，如果是列表就是数组，如果是信息就是对象，如果是数值就是单个标量等
}
```

### 更多样本

一个用户信息查询接口的结果：

```js
{
	message : '查询成功',
	code : 0,
	data : {
		id : 99,
		name : 'Jay',
		age : 18
	}
}
```

---

一个结算购买过程中的提示：

```js
{
	message : '购买失败，您的余额已不足，请及时充值',
	code : 1,
	data : {
		remain_money : 17 //剩余金钱
	}
}
```

---

一个新闻频道列表：

```js
{
	message : '', //前端没有提示的需求，一般不需要多余地写“查询成功”，直接设空，用code=0表示正常查询并给出数据就是了
	code : 0,
	data : [
		{
			id : 11,
			name : '焦点'
		},
		{
			id : 12,
			name : '科技'
		},
		{
			id : 12,
			name : '社会'
		}
	]
}
```

---

### 接口文档

所有后端输出数据给前端都要写文档，文档目录在`/docs/前端接口`里以markdown文档的形式表达

其中文档描述的接口地址有时候是这样的：`/project/$项目ID.json`，这里的`$项目ID`是指一个变量

---

### 后端实现

通常直接在action里执行`new \xoa\common\ext\web\Response($message, $code, $data)`即可输出这个规范的JSON

其中$code默认为1，因为经常都是用于报错，而$data默认为null

基本上随便找一个控制器都能找到这优返回代码